<div class="container-fluid">
<div class="row">
    <div class="col-sm-12">
        <p>
            <button type="button" class="btn btn-primary" onclick="PridatZmenitUnitTest(0);"><i class="fa fa-plus"></i>&nbsp;Pridať</button>
            <button type="button" class="btn btn-primary" onclick="SpustiVsetkyUT();"><i class="fa fa-bolt"></i>&nbsp;Spustiť všetky unit testy kontextu</button>
        </p>
    </div>
    <div class="col-sm-12">
        <div class="table-responsive">
            <table class="table table-striped table-bordered" style="width:100%" id="zoznam_ut">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Status</th>
                        <th>Názov</th>
                        <th>Volaná funkcia</th>
                        <th>Poradie</th>
                        <th>Dátum behu</th>
                        <th style="width:100px;">Kto</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
    <script>
    function SpustiVsetkyUT(){
        var kt_id = $('#kt_id').val();
        SpustiUnitTestyKontextu(kt_id, function(){reloadUnitTests();},function(){reloadUnitTests();});
    }

    function PridatZmenitUnitTest(id){
        loadTemplateIntoLargeScreenModal('#defaultModal2', 'largescreen', 'Pridať/zmeniť unit test',
        '/pridat_zmenit_unit_test/?ut_id='+id+'&kontext_id={{kontext_id}}');
    }

    function unitTestGridFormatter(data, type, row){
        var e = "<li><a href='javascript:PridatZmenitUnitTest(" + row.id + ");' title='Zmeniť unit test'><span class='fa fa-pencil-alt fa-sm'></span>&nbsp;Zmeniť unit test</a></li>";
        var f = "<li><a href='javascript:ZmazUnitTest(" + row.id + ", function(){ reloadUnitTests(); });' title='Zmazať unit test'><span class='fa fa-trash-alt fa-sm'></span>&nbsp;Zmazať unit test</a></li>";
        var c = "<li><a href='javascript:SpustiUnitTest(" + row.id + ", function(){ reloadUnitTests(); });' title='Spustiť unit test'><span class='fa fa-cogs fa-sm'></span>&nbsp;Spustiť unit test</a></li>";

        return gridButtonFormater(e+f+c, '', true);
    }

    function unitTestStatusFormatter(data, type, row){
        return daj_ut_status(data);
    }

    var tableUT = $("#zoznam_ut").DataTable({
        responsive : true,
        serverSide : true,
        processing : true,
        searching : false,
        createdRow : function( row, data, dataIndex){
            $(row).addClass(daj_ut_status_class(data['status']));
        },
        language: {
           url : "{{ url_for("static", filename="js/datatables_slovak.json") }}"
        },
        dom : '<<"row"<"col-sm-12"tr>><"row"<"col-lg-4"i><"col-lg-4"l><"col-lg-4"p>>>',
        ajax: {
            url : "{{ url_for("kontext.daj_unit_testy") }}",
            data : function ( d ) {
                d.kontext_id = '{{ kontext_id }}';
            },
        },
        columns: [
            { data  : "id" ,
              render: function(data, type, row){
                    return unitTestGridFormatter(data, type, row);
                }
            },
            { data: "status",
              render: function(data, type, row){
                    return unitTestStatusFormatter(data, type, row);
                }
            },
            { data: "nazov" },
            { data: "funkcia" },
            { data: "poradie" },
            { data: "datum_posledneho_behu" },
            { data: "spustac_posledneho_behu" , "orderable": "false"},
        ]
        });

    function reloadUnitTests(){
        tableUT.ajax.reload();
    }

</script>
</div>
